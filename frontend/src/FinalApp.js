import React, { useState } from 'react';\n\nfunction App() {\n  const [query, setQuery] = useState('');\n  const [result, setResult] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  const search = async () => {\n    if (!query.trim()) {\n      setError('Please enter a medicine name');\n      return;\n    }\n    \n    setLoading(true);\n    setError(null);\n    setResult(null);\n    \n    try {\n      // Try multiple endpoints to find working one\n      let response;\n      let data;\n      \n      // Try search endpoint first\n      try {\n        response = await fetch(`https://medicine-image-analyzer-1.onrender.com/api/search/${encodeURIComponent(query)}`);\n        if (response.ok) {\n          data = await response.json();\n          if (data.success) {\n            setResult(data.data);\n            return;\n          }\n        }\n      } catch (e) {\n        console.log('Search endpoint failed:', e.message);\n      }\n      \n      // Try medicine endpoint\n      try {\n        response = await fetch(`https://medicine-image-analyzer-1.onrender.com/api/medicine/${encodeURIComponent(query)}`);\n        if (response.ok) {\n          data = await response.json();\n          \n          // Get price separately\n          let priceData = null;\n          try {\n            const priceRes = await fetch(`https://medicine-image-analyzer-1.onrender.com/api/price/${encodeURIComponent(query)}`);\n            if (priceRes.ok) {\n              const priceResult = await priceRes.json();\n              priceData = priceResult.success ? priceResult.data : null;\n            }\n          } catch (priceError) {\n            console.log('Price fetch failed:', priceError.message);\n          }\n          \n          setResult({\n            medicineName: query,\n            medicineInfo: data.success ? data.data : { fda: { genericName: 'Not available', indications: 'Not available' } },\n            priceInfo: priceData\n          });\n          return;\n        }\n      } catch (e) {\n        console.log('Medicine endpoint failed:', e.message);\n      }\n      \n      // If all endpoints fail, show mock data\n      setResult({\n        medicineName: query,\n        medicineInfo: {\n          fda: {\n            genericName: 'Information not available',\n            manufacturer: 'Please consult a pharmacist',\n            indications: 'This is a demo application. For actual medicine information, consult a healthcare professional.',\n            warnings: 'Always read medicine labels and consult healthcare providers.'\n          }\n        },\n        priceInfo: {\n          min: 20,\n          max: 100,\n          unit: 'strip',\n          disclaimer: 'Approximate price for reference only'\n        }\n      });\n      \n    } catch (e) {\n      setError(`Connection failed: ${e.message}. Server may be starting up.`);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div style={{ \n      padding: '20px', \n      maxWidth: '800px', \n      margin: '0 auto', \n      fontFamily: 'Arial, sans-serif',\n      background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\n      minHeight: '100vh'\n    }}>\n      <div style={{ textAlign: 'center', marginBottom: '30px' }}>\n        <h1 style={{ color: 'white', fontSize: '2.5rem', margin: '0' }}>‚öïÔ∏è Medicine Info</h1>\n        <p style={{ color: 'white', opacity: 0.9 }}>Search for medicine information</p>\n      </div>\n      \n      <div style={{ \n        background: 'white', \n        padding: '30px', \n        borderRadius: '15px', \n        boxShadow: '0 10px 30px rgba(0,0,0,0.2)',\n        marginBottom: '20px'\n      }}>\n        <div style={{ display: 'flex', gap: '10px', marginBottom: '20px' }}>\n          <input \n            type=\"text\"\n            value={query} \n            onChange={e => setQuery(e.target.value)}\n            onKeyPress={e => e.key === 'Enter' && search()}\n            placeholder=\"Enter medicine name (e.g., Paracetamol, Aspirin)\"\n            style={{ \n              flex: 1,\n              padding: '12px', \n              border: '2px solid #ddd', \n              borderRadius: '8px',\n              fontSize: '16px'\n            }}\n          />\n          <button \n            onClick={search} \n            disabled={loading}\n            style={{ \n              padding: '12px 24px',\n              background: loading ? '#ccc' : '#2c5aa0',\n              color: 'white',\n              border: 'none',\n              borderRadius: '8px',\n              cursor: loading ? 'not-allowed' : 'pointer',\n              fontSize: '16px',\n              fontWeight: 'bold'\n            }}\n          >\n            {loading ? 'Searching...' : 'üîç Search'}\n          </button>\n        </div>\n        \n        {loading && (\n          <div style={{ textAlign: 'center', color: '#666' }}>\n            <p>Searching... Server may take 30-60 seconds to respond on first request.</p>\n          </div>\n        )}\n        \n        {error && (\n          <div style={{ \n            background: '#f8d7da', \n            color: '#721c24', \n            padding: '15px', \n            borderRadius: '8px',\n            border: '1px solid #f5c6cb'\n          }}>\n            ‚ùå {error}\n          </div>\n        )}\n      </div>\n      \n      {result && (\n        <div style={{ \n          background: 'white', \n          padding: '30px', \n          borderRadius: '15px', \n          boxShadow: '0 10px 30px rgba(0,0,0,0.2)'\n        }}>\n          <h2 style={{ color: '#2c5aa0', marginTop: 0 }}>üìã {result.medicineName}</h2>\n          \n          <div style={{ marginBottom: '20px' }}>\n            <h3 style={{ color: '#666', borderBottom: '2px solid #f0f0f0', paddingBottom: '10px' }}>Basic Information</h3>\n            <p><strong>Generic Name:</strong> {result.medicineInfo?.fda?.genericName || 'Not available'}</p>\n            <p><strong>Manufacturer:</strong> {result.medicineInfo?.fda?.manufacturer || 'Not available'}</p>\n          </div>\n          \n          <div style={{ marginBottom: '20px' }}>\n            <h3 style={{ color: '#666', borderBottom: '2px solid #f0f0f0', paddingBottom: '10px' }}>Usage & Warnings</h3>\n            <p><strong>Indications:</strong> {result.medicineInfo?.fda?.indications || 'Consult healthcare provider'}</p>\n            <p><strong>Warnings:</strong> {result.medicineInfo?.fda?.warnings || 'Read medicine label carefully'}</p>\n          </div>\n          \n          {result.priceInfo && (\n            <div style={{ \n              background: '#e7f3ff', \n              padding: '20px', \n              borderRadius: '10px',\n              marginBottom: '20px'\n            }}>\n              <h3 style={{ color: '#0066cc', marginTop: 0 }}>üí∞ Approximate Price</h3>\n              <p style={{ fontSize: '20px', fontWeight: 'bold', margin: '10px 0' }}>\n                ‚Çπ{result.priceInfo.min} - ‚Çπ{result.priceInfo.max} per {result.priceInfo.unit}\n              </p>\n              <p style={{ fontSize: '14px', color: '#666', margin: 0 }}>\n                {result.priceInfo.disclaimer}\n              </p>\n            </div>\n          )}\n          \n          <div style={{ \n            background: '#fff3cd', \n            padding: '20px', \n            borderRadius: '10px',\n            border: '1px solid #ffeaa7'\n          }}>\n            <p style={{ margin: 0, fontWeight: 'bold' }}>\n              ‚ö†Ô∏è Medical Disclaimer: This information is for educational purposes only. \n              Always consult a licensed healthcare professional before taking any medication.\n            </p>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default App;